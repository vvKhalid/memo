<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Memo Generator (Exact Match)</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/docx/5.5.0/docx.min.js"></script>
</head>
<body>

<h2>Inspection Memo Input</h2>

<div id="observations"></div>

<button onclick="addObservation()">‚ûï Add Observation</button>
<button onclick="generateWord()">üìÑ Generate Memo Word File</button>

<script>
  function addObservation() {
    const container = document.getElementById('observations');
    const count = container.children.length + 1;

    const div = document.createElement('div');
    div.className = 'observation';
    div.innerHTML = `
      <h3>Observation ${count}</h3>
      <label>Date/Time: <input type="text" name="date"></label><br>
      <label>Inspected Area: <input type="text" name="area"></label><br>
      <label>Findings/Observations: <textarea name="findings"></textarea></label><br>
      <label>Attached Photo(s): <input type="text" name="photo"></label><br>
      <label>Status of Finding: <input type="text" name="status"></label><br><br>
    `;
    container.appendChild(div);
  }

  async function generateWord() {
    const doc = new docx.Document();

    // 1Ô∏è‚É£ Intro Paragraph
    const intro = new docx.Paragraph({
      children: [
        new docx.TextRun("We would like to bring to your kind attention the below observations noted by our representative from the General Services Inspection during the above-mentioned period;"),
      ],
      spacing: { after: 300 }
    });

    // 2Ô∏è‚É£ Table Header Row
    const tableRows = [
      new docx.TableRow({
        children: [
          new docx.TableCell({ children: [new docx.Paragraph("No.")]}),
          new docx.TableCell({ children: [new docx.Paragraph("Date/Time")]}),
          new docx.TableCell({ children: [new docx.Paragraph("Inspected Area")]}),
          new docx.TableCell({ children: [new docx.Paragraph("Findings/Observations")]}),
          new docx.TableCell({ children: [new docx.Paragraph("Attached Photo")]}),
          new docx.TableCell({ children: [new docx.Paragraph("Status of Finding")]}),
        ],
      }),
    ];

    // 3Ô∏è‚É£ Add Data Rows Dynamically
    const observations = document.querySelectorAll('.observation');
    observations.forEach((obs, index) => {
      const date = obs.querySelector('input[name="date"]').value || '-';
      const area = obs.querySelector('input[name="area"]').value || '-';
      const findings = obs.querySelector('textarea[name="findings"]').value || '-';
      const photo = obs.querySelector('input[name="photo"]').value || '-';
      const status = obs.querySelector('input[name="status"]').value || '-';

      tableRows.push(new docx.TableRow({
        children: [
          new docx.TableCell({ children: [new docx.Paragraph(String(index + 1))]}),
          new docx.TableCell({ children: [new docx.Paragraph(date)]}),
          new docx.TableCell({ children: [new docx.Paragraph(area)]}),
          new docx.TableCell({ children: [new docx.Paragraph(findings)]}),
          new docx.TableCell({ children: [new docx.Paragraph(photo)]}),
          new docx.TableCell({ children: [new docx.Paragraph(status)]}),
        ],
      }));
    });

    const table = new docx.Table({
      rows: tableRows,
      width: { size: 100, type: "pct" },
    });

    // 4Ô∏è‚É£ Closing Paragraphs
    const closing1 = new docx.Paragraph("Kindly see the inspection photos Attached for your easy reference.");
    const closing2 = new docx.Paragraph("We would appreciate your feedback on action/s taken regarding the above observations within five (05) days of receiving this memorandum.");
    const closing3 = new docx.Paragraph("Thank you for your usual cooperation.");
    const closing4 = new docx.Paragraph("Best Regards.");

    // 5Ô∏è‚É£ Assemble Document
    doc.addSection({
      children: [intro, table, closing1, closing2, closing3, closing4]
    });

    const blob = await docx.Packer.toBlob(doc);
    const link = document.createElement('a');
    link.href = URL.createObjectURL(blob);
    link.download = 'InspectionMemo.docx';
    link.click();
  }

  // Add first row by default
  addObservation();
</script>

</body>
</html>
